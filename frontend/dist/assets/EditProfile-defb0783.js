import{h as M,j as D,k as q,r as u,l as e,L as F,n as B,X as G,z as h}from"./index-c8ecdaf5.js";import{u as R}from"./user-81303df7.js";import{S as T,u as W}from"./upload-3aa29066.js";import{A as H}from"./arrow-left-2a131540.js";const $=M("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]),K=()=>{var N,w,k,L,C;const{user:r,updateUser:A}=D(),S=q(),[f,y]=u.useState(!1),[v,j]=u.useState(null),[x,g]=u.useState(""),p=(r==null?void 0:r.role)==="admin"?"/admin":"/profile",[o,b]=u.useState({username:"",firstName:"",lastName:"",bio:"",avatar:"",socialLinks:{twitter:"",linkedin:"",github:"",website:""}});u.useEffect(()=>{var i,a,t,s;r&&(b({username:r.username||"",firstName:r.firstName||"",lastName:r.lastName||"",bio:r.bio||"",avatar:r.avatar||"",socialLinks:{twitter:((i=r.socialLinks)==null?void 0:i.twitter)||"",linkedin:((a=r.socialLinks)==null?void 0:a.linkedin)||"",github:((t=r.socialLinks)==null?void 0:t.github)||"",website:((s=r.socialLinks)==null?void 0:s.website)||""}}),g(r.avatar||""))},[r]);const d=i=>{const{name:a,value:t}=i.target;if(a.startsWith("socialLinks.")){const s=a.split(".")[1];b(n=>({...n,socialLinks:{...n.socialLinks,[s]:t}}))}else b(s=>({...s,[a]:t}))},P=i=>{var t;const a=(t=i.target.files)==null?void 0:t[0];if(a){if(!a.type.startsWith("image/")){h.error("Please select an image file");return}if(a.size>5*1024*1024){h.error("Image size should be less than 5MB");return}j(a);const s=new FileReader;s.onload=()=>{g(s.result)},s.readAsDataURL(a)}},E=()=>{j(null),g(""),b(i=>({...i,avatar:""}))},U=async i=>{var a,t;try{return(await W.uploadImage(i)).data.url}catch(s){console.error("Avatar upload error:",s);let n="Failed to upload avatar";throw(t=(a=s.response)==null?void 0:a.data)!=null&&t.message?n=s.response.data.message:s.message&&(n=s.message),new Error(n)}},I=async i=>{var a,t,s,n;i.preventDefault(),y(!0);try{let l={...o};if(v){const m=await U(v);l.avatar=m}else x===""&&o.avatar&&(l.avatar="");const c=await R.updateProfile(l);console.log("Updated user response:",c),A(c),h.success("Profile updated successfully!"),S(p)}catch(l){console.error("Error updating profile:",l),console.error("Error response:",l.response);let c="Failed to update profile";if((t=(a=l.response)==null?void 0:a.data)!=null&&t.message)c=l.response.data.message;else if((n=(s=l.response)==null?void 0:s.data)!=null&&n.errors){const m=l.response.data.errors;Array.isArray(m)&&m.length>0&&(c=m.map(z=>z.message).join(", "))}else l.message&&(c=l.message);h.error(c)}finally{y(!1)}};return r?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white border-b border-gray-200",children:e.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsx("div",{className:"flex items-center justify-between py-6",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(F,{to:p,className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(H,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Edit Profile"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Update your personal information and preferences"})]})]})})})}),e.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsx(B.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:e.jsxs("form",{onSubmit:I,children:[e.jsxs("div",{className:"px-6 py-8 border-b border-gray-200",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-6",children:"Profile Picture"}),e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-24 h-24 bg-gradient-to-r from-purple-500 to-indigo-600 rounded-full flex items-center justify-center overflow-hidden",children:x?e.jsx("img",{src:x,alt:"Avatar preview",className:"w-full h-full object-cover"}):e.jsx("span",{className:"text-white text-2xl font-semibold",children:(N=r.fullName)==null?void 0:N.charAt(0).toUpperCase()})}),x&&e.jsx("button",{type:"button",onClick:E,className:"absolute -top-2 -right-2 p-1 bg-red-500 text-white rounded-full hover:bg-red-600 transition-colors",children:e.jsx(G,{className:"h-3 w-3"})})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("label",{htmlFor:"avatar",className:"cursor-pointer inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[e.jsx($,{className:"h-4 w-4 mr-2"}),"Change Avatar"]}),e.jsx("input",{id:"avatar",type:"file",accept:"image/*",onChange:P,className:"hidden"}),e.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"JPG, GIF or PNG. Max size of 5MB."})]})]})]}),e.jsxs("div",{className:"px-6 py-8 border-b border-gray-200",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-6",children:"Basic Information"}),e.jsx("div",{className:"grid grid-cols-1 gap-6 mb-6",children:e.jsxs("div",{children:[e.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-2",children:"Username"}),e.jsx("input",{type:"text",id:"username",name:"username",value:o.username,onChange:d,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter your username",pattern:"^[a-zA-Z0-9_]+$",title:"Username can only contain letters, numbers, and underscores",required:!0}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"3-30 characters. Letters, numbers, and underscores only."})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"firstName",className:"block text-sm font-medium text-gray-700 mb-2",children:"First Name"}),e.jsx("input",{type:"text",id:"firstName",name:"firstName",value:o.firstName,onChange:d,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"lastName",className:"block text-sm font-medium text-gray-700 mb-2",children:"Last Name"}),e.jsx("input",{type:"text",id:"lastName",name:"lastName",value:o.lastName,onChange:d,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("label",{htmlFor:"bio",className:"block text-sm font-medium text-gray-700 mb-2",children:"Bio"}),e.jsx("textarea",{id:"bio",name:"bio",rows:4,value:o.bio,onChange:d,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Tell us about yourself..."})]})]}),e.jsxs("div",{className:"px-6 py-8",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-6",children:"Social Links"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"twitter",className:"block text-sm font-medium text-gray-700 mb-2",children:"Twitter"}),e.jsx("input",{type:"url",id:"twitter",name:"socialLinks.twitter",value:(w=o.socialLinks)==null?void 0:w.twitter,onChange:d,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"https://twitter.com/username"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"linkedin",className:"block text-sm font-medium text-gray-700 mb-2",children:"LinkedIn"}),e.jsx("input",{type:"url",id:"linkedin",name:"socialLinks.linkedin",value:(k=o.socialLinks)==null?void 0:k.linkedin,onChange:d,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"https://linkedin.com/in/username"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"github",className:"block text-sm font-medium text-gray-700 mb-2",children:"GitHub"}),e.jsx("input",{type:"url",id:"github",name:"socialLinks.github",value:(L=o.socialLinks)==null?void 0:L.github,onChange:d,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"https://github.com/username"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"website",className:"block text-sm font-medium text-gray-700 mb-2",children:"Website"}),e.jsx("input",{type:"url",id:"website",name:"socialLinks.website",value:(C=o.socialLinks)==null?void 0:C.website,onChange:d,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"https://yourwebsite.com"})]})]})]}),e.jsxs("div",{className:"px-6 py-6 bg-gray-50 border-t border-gray-200 flex justify-end space-x-3",children:[e.jsx(F,{to:p,className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:f,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center space-x-2",children:f?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),e.jsx("span",{children:"Saving..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(T,{className:"h-4 w-4"}),e.jsx("span",{children:"Save Changes"})]})})]})]})})})]}):e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("div",{className:"text-center",children:e.jsx("p",{className:"text-gray-500",children:"Loading..."})})})};export{K as default};
//# sourceMappingURL=EditProfile-defb0783.js.map
