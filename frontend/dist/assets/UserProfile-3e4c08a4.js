import{h as Y,x as oe,j as ce,k as de,r as c,l as e,s as q,L as g,y as me,G as xe,n as b,o as he}from"./index-55320310.js";import{u as p}from"./user-9cd5a514.js";import{P as v}from"./pen-line-cd332607.js";import{G as ge}from"./globe-f1ddc1f5.js";import{T as pe}from"./twitter-96811826.js";import{B as I}from"./bar-chart-3-5daf79b5.js";import{F as W}from"./file-text-bf5ff692.js";import{E as S}from"./eye-7cfc2af4.js";import{H as X,M as ue}from"./message-circle-c3254eb4.js";import{U as fe}from"./users-14a33004.js";import{C as ye}from"./calendar-47f21c6b.js";import{T as be}from"./trash-2-06439beb.js";import{C as K}from"./clock-25d4086b.js";import{A as je}from"./alert-circle-de04b2cc.js";import{C as Ne}from"./check-circle-cb83e853.js";import{X as ve}from"./x-circle-82ddcf64.js";const O=Y("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),we=Y("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),De=()=>{var _,T,V,D,G,z,H;const{username:w}=oe(),{user:n}=ce(),k=de(),r=!w||w===(n==null?void 0:n.username),B=w||(n==null?void 0:n.username),[t,P]=c.useState(null),[C,$]=c.useState([]),[l,j]=c.useState("published"),[J,L]=c.useState(!0),[Q,E]=c.useState(!1),[d,F]=c.useState({totalViews:0,totalLikes:0,totalComments:0,publishedBlogs:0,draftBlogs:0,pendingBlogs:0,rejectedBlogs:0}),[f,U]=c.useState(!1),Z=s=>{s.status==="approved"?k(`/blog/${s.slug}`):r&&(s.status==="draft"||s.status==="pending"?k(`/edit/${s._id}`):s.status==="rejected"&&k(`/edit/${s._id}`))},N=s=>s.status==="approved"||r,ee=s=>{if(!N(s))return"";if(s.status==="approved")return"Click to view blog";if(r){if(s.status==="draft")return"Click to continue editing";if(s.status==="pending")return"Click to view or edit";if(s.status==="rejected")return"Click to edit and resubmit"}return""};c.useEffect(()=>{r&&n?(P(n),L(!1),R(n)):B&&se()},[B,n,r]),c.useEffect(()=>{t&&l&&te()},[t,l]),c.useEffect(()=>{t&&M()},[t,r]);const A=s=>{const a=s.reduce((i,y)=>{var h;return i+(((h=y.metrics)==null?void 0:h.views)||0)},0),o=s.reduce((i,y)=>{var h;return i+(((h=y.metrics)==null?void 0:h.likes)||0)},0),m=s.reduce((i,y)=>{var h;return i+(((h=y.metrics)==null?void 0:h.comments)||0)},0),u=s.filter(i=>i.status==="approved").length,x=s.filter(i=>i.status==="draft").length,ie=s.filter(i=>i.status==="pending").length,ne=s.filter(i=>i.status==="rejected").length;F({totalViews:a,totalLikes:o,totalComments:m,publishedBlogs:u,draftBlogs:x,pendingBlogs:ie,rejectedBlogs:ne})},se=async()=>{try{L(!0);const s=await p.getUserByUsername(B);P(s)}catch(s){console.error("Error fetching user profile:",s)}finally{L(!1)}},M=async()=>{if(t)try{if(U(!0),r){const[s,a,o,m]=await Promise.all([p.getMyBlogs("approved"),p.getMyBlogs("draft"),p.getMyBlogs("pending"),p.getMyBlogs("rejected")]),u=[...s.blogs,...a.blogs,...o.blogs,...m.blogs];A(u)}else{const s=await p.getUserBlogs(t.username);A(s.blogs)}}catch(s){console.error("Error fetching blogs for stats:",s),R(t)}finally{U(!1)}},te=async()=>{if(t)try{E(!0);let s;if(r){const a=l==="published"?"approved":l==="drafts"?"draft":l==="pending"?"pending":l==="rejected"?"rejected":void 0;s=await p.getMyBlogs(a)}else s=await p.getUserBlogs(t.username);$(s.blogs)}catch(s){console.error("Error fetching user blogs:",s)}finally{E(!1)}},R=s=>{const a=s.stats||{};F({totalViews:a.totalViews||0,totalLikes:a.totalLikes||0,totalComments:0,publishedBlogs:a.totalBlogs||0,draftBlogs:0,pendingBlogs:0,rejectedBlogs:0})},re=async s=>{if(window.confirm("Are you sure you want to delete this blog?"))try{await he.deleteBlog(s),$(C.filter(a=>a._id!==s)),r&&M()}catch(a){console.error("Error deleting blog:",a)}},ae=s=>{const a={approved:{color:"bg-green-100 text-green-800",icon:Ne,label:"Published"},pending:{color:"bg-yellow-100 text-yellow-800",icon:K,label:"Pending Review"},draft:{color:"bg-gray-100 text-gray-800",icon:v,label:"Draft"},rejected:{color:"bg-red-100 text-red-800",icon:ve,label:"Rejected"}},o=a[s]||a.draft,m=o.icon;return e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${o.color}`,children:[e.jsx(m,{className:"h-3 w-3 mr-1"}),o.label]})},le=s=>new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});return J?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx(q,{size:"lg"})}):t?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white border-b border-gray-200",children:e.jsx("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center space-y-4 md:space-y-0 md:space-x-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-24 h-24 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white text-2xl font-bold overflow-hidden",children:t.avatar?e.jsx("img",{src:t.avatar,alt:t.fullName||t.username,className:"w-full h-full object-cover"}):((_=t.firstName)==null?void 0:_.charAt(0).toUpperCase())||((T=t.username)==null?void 0:T.charAt(0).toUpperCase())}),r&&e.jsx(g,{to:"/profile/edit",className:"absolute -bottom-2 -right-2 bg-white rounded-full p-2 shadow-md border border-gray-200 hover:bg-gray-50 transition-colors",title:"Edit avatar",children:e.jsx(v,{className:"h-4 w-4 text-gray-600"})})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-4 mb-2",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:t.fullName||t.username}),r&&e.jsxs(g,{to:"/profile/edit",className:"inline-flex items-center px-3 py-1.5 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 transition-colors",children:[e.jsx(we,{className:"h-4 w-4 mr-1"}),"Edit Profile"]})]}),e.jsxs("p",{className:"text-gray-600 mb-3",children:["@",t.username]}),t.bio&&e.jsx("p",{className:"text-gray-700 mb-4 max-w-2xl",children:t.bio}),e.jsxs("div",{className:"flex items-center space-x-4",children:[((V=t.socialLinks)==null?void 0:V.website)&&e.jsx("a",{href:t.socialLinks.website,target:"_blank",rel:"noopener noreferrer",className:"text-gray-600 hover:text-gray-900",children:e.jsx(ge,{className:"h-5 w-5"})}),((D=t.socialLinks)==null?void 0:D.twitter)&&e.jsx("a",{href:t.socialLinks.twitter,target:"_blank",rel:"noopener noreferrer",className:"text-gray-600 hover:text-blue-500",children:e.jsx(pe,{className:"h-5 w-5"})}),((G=t.socialLinks)==null?void 0:G.linkedin)&&e.jsx("a",{href:t.socialLinks.linkedin,target:"_blank",rel:"noopener noreferrer",className:"text-gray-600 hover:text-blue-700",children:e.jsx(me,{className:"h-5 w-5"})}),((z=t.socialLinks)==null?void 0:z.github)&&e.jsx("a",{href:t.socialLinks.github,target:"_blank",rel:"noopener noreferrer",className:"text-gray-600 hover:text-gray-900",children:e.jsx(xe,{className:"h-5 w-5"})})]})]}),e.jsxs("div",{className:"flex space-x-3",children:[!r&&e.jsxs(g,{to:`/analytics/${t._id}`,className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(I,{className:"h-4 w-4 mr-2"}),"View Analytics"]}),r&&e.jsxs(e.Fragment,{children:[e.jsxs(g,{to:"/analytics",className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(I,{className:"h-4 w-4 mr-2"}),"My Analytics"]}),e.jsxs(g,{to:"/write",className:"inline-flex items-center px-4 py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 transition-colors",children:[e.jsx(O,{className:"h-4 w-4 mr-2"}),"Write Blog"]})]})]})]})})}),e.jsxs("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Statistics"})}),e.jsxs("div",{className:`grid grid-cols-2 md:grid-cols-4 gap-4 mb-8 transition-opacity ${f?"opacity-70":"opacity-100"}`,children:[e.jsx(b.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:`bg-white rounded-lg p-4 border border-gray-200 ${f?"animate-pulse":""}`,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(W,{className:"h-8 w-8 text-blue-600"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Blogs"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:d.publishedBlogs})]})]})}),e.jsx(b.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:`bg-white rounded-lg p-4 border border-gray-200 ${f?"animate-pulse":""}`,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(S,{className:"h-8 w-8 text-green-600"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Views"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:d.totalViews.toLocaleString()})]})]})}),e.jsx(b.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:`bg-white rounded-lg p-4 border border-gray-200 ${f?"animate-pulse":""}`,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(X,{className:"h-8 w-8 text-red-600"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Likes"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:d.totalLikes.toLocaleString()})]})]})}),e.jsx(b.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:`bg-white rounded-lg p-4 border border-gray-200 ${f?"animate-pulse":""}`,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(fe,{className:"h-8 w-8 text-purple-600"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Followers"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:((H=t.stats)==null?void 0:H.followersCount)||0})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200",children:[e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"flex space-x-8 px-6","aria-label":"Tabs",children:r?e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>j("published"),className:`py-4 px-1 border-b-2 font-medium text-sm ${l==="published"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:["Published (",d.publishedBlogs,")"]}),e.jsxs("button",{onClick:()=>j("drafts"),className:`py-4 px-1 border-b-2 font-medium text-sm ${l==="drafts"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:["Drafts (",d.draftBlogs,")"]}),e.jsxs("button",{onClick:()=>j("pending"),className:`py-4 px-1 border-b-2 font-medium text-sm ${l==="pending"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:["Pending Review (",d.pendingBlogs,")"]}),e.jsxs("button",{onClick:()=>j("rejected"),className:`py-4 px-1 border-b-2 font-medium text-sm ${l==="rejected"?"border-red-500 text-red-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:["Rejected (",d.rejectedBlogs,")"]})]}):e.jsxs("button",{className:"py-4 px-1 border-b-2 border-blue-500 font-medium text-sm text-blue-600",children:["Published Blogs (",d.publishedBlogs,")"]})})}),e.jsx("div",{className:"p-6",children:Q?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(q,{size:"md"})}):C.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(W,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:l==="published"?"No published blogs yet":l==="drafts"?"No drafts yet":l==="pending"?"No pending blogs":l==="rejected"?"No rejected blogs":"No blogs yet"}),e.jsx("p",{className:"text-gray-600 mb-6",children:r?l==="rejected"?"No blogs have been rejected. Keep writing quality content!":"Start writing to share your knowledge with the community!":"This user hasn't published any blogs yet."}),r&&e.jsxs(g,{to:"/write",className:"inline-flex items-center px-4 py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 transition-colors",children:[e.jsx(O,{className:"h-4 w-4 mr-2"}),"Write Your First Blog"]})]}):e.jsx("div",{className:"space-y-6",children:C.map((s,a)=>{var o,m,u;return e.jsxs(b.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:a*.1},onClick:()=>N(s)&&Z(s),title:ee(s),className:`border border-gray-200 rounded-lg p-6 transition-all ${N(s)?"hover:shadow-md cursor-pointer hover:border-gray-300":"cursor-default"}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900 line-clamp-2",children:s.title}),ae(s.status)]}),s.status==="rejected"&&s.adminNotes&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 mb-3",children:[e.jsx("h4",{className:"text-sm font-medium text-red-900 mb-1",children:"Rejection Reason:"}),e.jsx("p",{className:"text-sm text-red-700",children:s.adminNotes})]}),e.jsx("p",{className:"text-gray-600 mb-3 line-clamp-2",children:s.excerpt||s.content.substring(0,150)+"..."}),e.jsxs("div",{className:"flex items-center space-x-6 text-sm text-gray-500",children:[e.jsxs("span",{className:"flex items-center space-x-1",children:[e.jsx(ye,{className:"h-4 w-4"}),e.jsx("span",{children:le(s.createdAt)})]}),e.jsxs("span",{className:"flex items-center space-x-1",children:[e.jsx(S,{className:"h-4 w-4"}),e.jsxs("span",{children:[((o=s.metrics)==null?void 0:o.views)||0," views"]})]}),e.jsxs("span",{className:"flex items-center space-x-1",children:[e.jsx(X,{className:"h-4 w-4"}),e.jsxs("span",{children:[((m=s.metrics)==null?void 0:m.likes)||0," likes"]})]}),e.jsxs("span",{className:"flex items-center space-x-1",children:[e.jsx(ue,{className:"h-4 w-4"}),e.jsxs("span",{children:[((u=s.metrics)==null?void 0:u.comments)||0," comments"]})]})]})]}),r&&e.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[e.jsx(g,{to:`/edit/${s._id}`,onClick:x=>x.stopPropagation(),className:"p-2 text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",children:e.jsx(v,{className:"h-4 w-4"})}),e.jsx("button",{onClick:x=>{x.stopPropagation(),re(s._id)},className:"p-2 text-gray-600 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:e.jsx(be,{className:"h-4 w-4"})})]})]}),s.tags&&s.tags.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.tags.slice(0,5).map(x=>e.jsx("span",{className:"bg-gray-100 text-gray-700 px-2 py-1 rounded-md text-xs",children:x},x)),s.tags.length>5&&e.jsxs("span",{className:"text-gray-500 text-xs",children:["+",s.tags.length-5," more"]})]}),N(s)&&e.jsx("div",{className:"mt-4 pt-3 border-t border-gray-100",children:e.jsx("p",{className:"text-xs text-gray-500 flex items-center",children:s.status==="approved"?e.jsxs(e.Fragment,{children:[e.jsx(S,{className:"h-3 w-3 mr-1"}),"Click to view blog"]}):r?s.status==="draft"?e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"h-3 w-3 mr-1"}),"Click to continue editing"]}):s.status==="pending"?e.jsxs(e.Fragment,{children:[e.jsx(K,{className:"h-3 w-3 mr-1"}),"Click to view or edit"]}):s.status==="rejected"?e.jsxs(e.Fragment,{children:[e.jsx(je,{className:"h-3 w-3 mr-1"}),"Click to edit and resubmit"]}):null:null})})]},s._id)})})})]})]})]}):e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"User Not Found"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"The user you're looking for doesn't exist."}),e.jsx(g,{to:"/",className:"bg-gray-900 text-white px-6 py-2 rounded-lg hover:bg-gray-800 transition-colors",children:"Go Home"})]})})};export{De as default};
//# sourceMappingURL=UserProfile-3e4c08a4.js.map
