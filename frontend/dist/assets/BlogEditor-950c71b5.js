import{h as D,r as n,l as e,X as P,n as i,x as A,k as B,j as F,o as k,z as p}from"./index-c8ecdaf5.js";import{u as U,S as z}from"./upload-3aa29066.js";import{A as E}from"./alert-circle-8bd9b0fa.js";import{C as L,F as W}from"./file-text-9e90c03d.js";import{A as G}from"./arrow-left-2a131540.js";import{C as R}from"./clock-8ead54b8.js";import{S as M}from"./send-3e800d81.js";import{T as O}from"./tag-c17e313c.js";const $=D("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),H=({value:N,onChange:o,placeholder:f="Upload featured image",className:w=""})=>{const[x,h]=n.useState(!1),[b,d]=n.useState(null),[S,u]=n.useState(!1),[C,t]=n.useState(!1),c=n.useRef(null),m=async r=>{var a,s;if(!r.type.startsWith("image/")){d("Please select an image file (JPG, PNG, GIF, WebP)");return}if(r.size>5*1024*1024){d("File size must be less than 5MB");return}h(!0),d(null),u(!1);try{const l=await U.uploadImage(r);if(l.status==="success")o(l.data.url),u(!0),setTimeout(()=>u(!1),3e3);else throw new Error(l.message||"Upload failed")}catch(l){console.error("Upload error:",l),d(((s=(a=l.response)==null?void 0:a.data)==null?void 0:s.message)||l.message||"Failed to upload image. Please try again.")}finally{h(!1)}},v=r=>{var s;const a=(s=r.target.files)==null?void 0:s[0];a&&m(a)},y=r=>{r.preventDefault(),r.stopPropagation(),r.type==="dragenter"||r.type==="dragover"?t(!0):r.type==="dragleave"&&t(!1)},g=r=>{var s;r.preventDefault(),r.stopPropagation(),t(!1);const a=(s=r.dataTransfer.files)==null?void 0:s[0];a&&m(a)},j=()=>{o(""),d(null),u(!1),c.current&&(c.current.value="")},I=()=>{var r;(r=c.current)==null||r.click()};return e.jsxs("div",{className:`space-y-3 ${w}`,children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Featured Image"}),N?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:N,alt:"Featured",className:"w-full h-48 object-cover rounded-lg border-2 border-gray-200"}),e.jsx("button",{onClick:j,className:"absolute top-2 right-2 p-1 bg-red-500 text-white rounded-full hover:bg-red-600 transition-colors",type:"button",children:e.jsx(P,{className:"h-4 w-4"})})]}):e.jsxs(i.div,{className:`relative border-2 border-dashed rounded-lg p-6 transition-colors ${C?"border-blue-400 bg-blue-50":"border-gray-300 hover:border-gray-400"} ${x?"opacity-50":""}`,onDragEnter:y,onDragLeave:y,onDragOver:y,onDrop:g,children:[e.jsx("div",{className:"text-center",children:x?e.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Uploading image..."})]}):e.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[e.jsx("div",{className:"flex items-center justify-center w-12 h-12 bg-gray-100 rounded-full",children:e.jsx($,{className:"h-6 w-6 text-gray-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:f}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Drag & drop or"," ",e.jsx("button",{type:"button",onClick:I,className:"text-blue-600 hover:text-blue-700 underline",children:"browse files"})]}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"PNG, JPG, GIF, WebP up to 5MB"})]})]})}),e.jsx("input",{ref:c,type:"file",accept:"image/*",onChange:v,className:"hidden",disabled:x})]}),b&&e.jsxs(i.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"flex items-center space-x-2 text-red-600 text-sm bg-red-50 p-3 rounded-lg",children:[e.jsx(E,{className:"h-4 w-4"}),e.jsx("span",{children:b})]}),S&&e.jsxs(i.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"flex items-center space-x-2 text-green-600 text-sm bg-green-50 p-3 rounded-lg",children:[e.jsx(L,{className:"h-4 w-4"}),e.jsx("span",{children:"Image uploaded successfully!"})]})]})},J=["Technology","Programming","AI/ML","Web Development","Mobile Development","DevOps","Database","Security","Tutorial","Opinion","News","Other"],ee=({mode:N="create"})=>{const{id:o}=A(),f=B();F();const[w,x]=n.useState(!1),[h,b]=n.useState(!1),[d,S]=n.useState(0),[u,C]=n.useState(1),[t,c]=n.useState({title:"",content:"",excerpt:"",category:"Other",tags:[],featuredImage:"",status:"draft"}),[m,v]=n.useState("");n.useEffect(()=>{o&&y()},[o]),n.useEffect(()=>{const a=t.content.split(/\s+/).filter(s=>s.length>0).length;S(a),C(Math.ceil(a/200)||1)},[t.content]);const y=async()=>{if(o)try{x(!0);const a=await k.getBlogById(o);a.status==="success"&&a.data&&c(a.data.blog)}catch(a){console.error("Error fetching blog:",a),a.isNetworkError||p.error(a.message||"Failed to load blog. Please try again.")}finally{x(!1)}},g=(a,s)=>{c(l=>({...l,[a]:s}))},j=()=>{m.trim()&&!t.tags.includes(m.trim())&&(c(a=>({...a,tags:[...a.tags,m.trim()]})),v(""))},I=a=>{c(s=>({...s,tags:s.tags.filter(l=>l!==a)}))},r=async a=>{if(!t.title.trim()||!t.content.trim()){alert("Please fill in the title and content");return}try{b(!0);const s={...t,status:a,featuredImage:t.featuredImage.trim()||void 0};let l;o?l=await k.updateBlog(o,s):l=await k.createBlog(s),l.status==="success"&&(a==="pending"?(p.success("Blog submitted for admin approval!"),f("/profile")):p.success("Blog saved as draft!"))}catch(s){if(console.error("Error saving blog:",s),s.errors&&Array.isArray(s.errors)){const l=s.errors.map(T=>T.message).join(", ");p.error(`Validation Error: ${l}`)}else s.message?p.error(s.message):p.error("Error saving blog. Please try again.")}finally{b(!1)}};return w?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading blog..."})]})}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white border-b border-gray-200 sticky top-0 z-10",children:e.jsx("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex items-center justify-between h-16",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(i.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>f(-1),className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(G,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:o?"Edit Blog":"Write New Blog"}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500 mt-1",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(W,{className:"h-4 w-4 mr-1"}),d," words"]}),e.jsxs("span",{className:"flex items-center",children:[e.jsx(R,{className:"h-4 w-4 mr-1"}),u," min read"]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs(i.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>r("draft"),disabled:h,className:"flex items-center px-4 py-2 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50",children:[e.jsx(z,{className:"h-4 w-4 mr-2"}),"Save Draft"]}),e.jsxs(i.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>r("pending"),disabled:h,className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:[e.jsx(M,{className:"h-4 w-4 mr-2"}),"Submit for Review"]})]})]})})}),e.jsx("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsx(i.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-xl border border-gray-200 p-6",children:e.jsx("input",{type:"text",placeholder:"Enter your blog title...",value:t.title,onChange:a=>g("title",a.target.value),className:"w-full text-3xl font-bold text-gray-900 placeholder-gray-400 border-none outline-none resize-none"})}),e.jsx(i.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white rounded-xl border border-gray-200 p-6",children:e.jsx("textarea",{placeholder:"Tell your blog...",value:t.content,onChange:a=>g("content",a.target.value),className:"w-full h-96 text-gray-900 placeholder-gray-400 border-none outline-none resize-none leading-relaxed"})}),e.jsxs(i.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white rounded-xl border border-gray-200 p-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Excerpt (Optional)"}),e.jsx("textarea",{placeholder:"Write a brief summary of your blog...",value:t.excerpt,onChange:a=>g("excerpt",a.target.value),className:"w-full h-24 text-gray-900 placeholder-gray-400 border border-gray-200 rounded-lg p-3 outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none",maxLength:300}),e.jsxs("div",{className:"text-right text-sm text-gray-500 mt-2",children:[t.excerpt.length,"/300"]})]})]}),e.jsxs("div",{className:"space-y-6",children:[o&&e.jsxs(i.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-xl border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Status"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${t.status==="approved"?"bg-green-500":t.status==="pending"?"bg-yellow-500":t.status==="rejected"?"bg-red-500":"bg-gray-400"}`}),e.jsx("span",{className:"text-sm font-medium text-gray-700 capitalize",children:t.status==="pending"?"Waiting for Admin Approval":t.status})]})]}),e.jsxs(i.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-white rounded-xl border border-gray-200 p-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Category"}),e.jsx("select",{value:t.category,onChange:a=>g("category",a.target.value),className:"w-full border border-gray-200 rounded-lg p-3 outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:J.map(a=>e.jsx("option",{value:a,children:a},a))})]}),e.jsxs(i.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"bg-white rounded-xl border border-gray-200 p-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Tags"}),e.jsxs("div",{className:"flex space-x-2 mb-3",children:[e.jsx("input",{type:"text",placeholder:"Add a tag...",value:m,onChange:a=>v(a.target.value),onKeyPress:a=>a.key==="Enter"&&j(),className:"flex-1 border border-gray-200 rounded-lg p-2 outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),e.jsx(i.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:j,className:"p-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:e.jsx(O,{className:"h-4 w-4"})})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.tags.map((a,s)=>e.jsxs(i.span,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"inline-flex items-center px-3 py-1 bg-blue-100 text-blue-800 text-sm rounded-full",children:[a,e.jsx("button",{onClick:()=>I(a),className:"ml-2 text-blue-600 hover:text-blue-800",children:"×"})]},s))})]}),e.jsx(i.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},className:"bg-white rounded-xl border border-gray-200 p-6",children:e.jsx(H,{value:t.featuredImage,onChange:a=>g("featuredImage",a),placeholder:"Upload your blog's featured image"})}),e.jsx(i.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6},className:"bg-blue-50 rounded-xl border border-blue-200 p-6",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(E,{className:"h-5 w-5 text-blue-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-blue-900 mb-2",children:"Submission Guidelines"}),e.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[e.jsx("li",{children:"• Ensure your content is original"}),e.jsx("li",{children:"• Add relevant tags for discoverability"}),e.jsx("li",{children:"• Write a compelling excerpt"}),e.jsx("li",{children:"• Submit for review when ready"})]})]})]})})]})]})})]})};export{ee as default};
//# sourceMappingURL=BlogEditor-950c71b5.js.map
